{"ast":null,"code":"/**\n * Scoring Engine for Swing Trade Analyzer\n * 75-point scoring system based on Minervini SEPA + CAN SLIM\n * \n * v2.0: Enhanced fundamental scoring with Defeat Beta data\n * \n * Scoring Breakdown:\n * - Technical: 40 points\n * - Fundamental: 20 points (ENHANCED)\n * - Sentiment: 10 points (placeholder)\n * - Risk/Macro: 5 points\n */\n\nimport { calculateIndicators } from './technicalIndicators';\nimport { calculateRS } from './rsCalculator';\n\n/**\n * Calculate Technical Analysis Score (40 points)\n */\nfunction calculateTechnicalScore(stockData, spyData) {\n  const prices = stockData.priceHistory.map(d => d.close);\n  const volumes = stockData.priceHistory.map(d => d.volume);\n  if (prices.length < 50) {\n    return {\n      score: 0,\n      maxScore: 40,\n      details: {},\n      error: 'Insufficient price data'\n    };\n  }\n  const indicators = calculateIndicators(prices, volumes);\n  const currentPrice = prices[prices.length - 1];\n  let scores = {\n    trendStructure: 0,\n    shortTermTrend: 0,\n    volume: 0,\n    rs: 0\n  };\n\n  // 1. Trend Structure (15 points): Price > 50 SMA > 200 SMA\n  if (indicators.sma50 && indicators.sma200) {\n    if (currentPrice > indicators.sma50 && indicators.sma50 > indicators.sma200) {\n      scores.trendStructure = 15; // Perfect Stage 2 uptrend\n    } else if (currentPrice > indicators.sma200) {\n      scores.trendStructure = 5; // Above 200 SMA but not ideal structure\n    }\n  }\n\n  // 2. Short-term Trend (10 points): Price > 8 EMA > 21 EMA\n  if (indicators.ema8 && indicators.ema21) {\n    if (currentPrice > indicators.ema8 && indicators.ema8 > indicators.ema21) {\n      scores.shortTermTrend = 10; // Strong short-term momentum\n    } else if (currentPrice > indicators.ema21) {\n      scores.shortTermTrend = 3; // Above 21 EMA\n    }\n  }\n\n  // 3. Volume (5 points): Recent volume vs 50-day average\n  if (indicators.avgVolume50) {\n    const recentVolume = volumes.slice(-5).reduce((a, b) => a + b, 0) / 5;\n    const volumeRatio = recentVolume / indicators.avgVolume50;\n    if (volumeRatio >= 1.5) {\n      scores.volume = 5; // High volume interest\n    } else if (volumeRatio >= 1.0) {\n      scores.volume = 2; // Normal volume\n    }\n  }\n\n  // 4. Relative Strength (10 points)\n  const rsData = calculateRS(stockData, spyData);\n  if (rsData && rsData.rs52Week) {\n    if (rsData.rs52Week >= 1.5) {\n      scores.rs = 10; // Strong outperformance\n    } else if (rsData.rs52Week >= 1.2) {\n      scores.rs = 7; // Good outperformance\n    } else if (rsData.rs52Week >= 1.0) {\n      scores.rs = 4; // Slight outperformance\n    } else if (rsData.rs52Week >= 0.8) {\n      scores.rs = 1; // Slight underperformance\n    }\n  }\n  const totalScore = scores.trendStructure + scores.shortTermTrend + scores.volume + scores.rs;\n  return {\n    score: totalScore,\n    maxScore: 40,\n    details: {\n      trendStructure: {\n        score: scores.trendStructure,\n        max: 15\n      },\n      shortTermTrend: {\n        score: scores.shortTermTrend,\n        max: 10\n      },\n      volume: {\n        score: scores.volume,\n        max: 5\n      },\n      relativeStrength: {\n        score: scores.rs,\n        max: 10\n      }\n    },\n    indicators: indicators,\n    rsData: rsData\n  };\n}\n\n/**\n * Calculate Fundamental Score (20 points)\n * ENHANCED with Defeat Beta data (ROE, ROIC, EPS Growth, etc.)\n */\nfunction calculateFundamentalScore(fundamentals) {\n  let scores = {\n    epsGrowth: 0,\n    revenueGrowth: 0,\n    roe: 0,\n    debtToEquity: 0,\n    forwardPe: 0\n  };\n  let dataSource = (fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.enrichedSource) || (fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.source) || 'unknown';\n  let dataQuality = 'limited';\n\n  // Check if we have enriched data from Defeat Beta\n  if (fundamentals !== null && fundamentals !== void 0 && fundamentals.enriched || (fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.source) === 'defeatbeta') {\n    dataQuality = 'rich';\n  }\n\n  // 1. EPS Growth (6 points)\n  // Target: >25% YoY = 6pts, 15-25% = 4pts, 10-15% = 2pts\n  const epsGrowth = fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.epsGrowth;\n  if (epsGrowth !== null && epsGrowth !== undefined) {\n    if (epsGrowth >= 25) {\n      scores.epsGrowth = 6;\n    } else if (epsGrowth >= 15) {\n      scores.epsGrowth = 4;\n    } else if (epsGrowth >= 10) {\n      scores.epsGrowth = 2;\n    } else if (epsGrowth > 0) {\n      scores.epsGrowth = 1;\n    }\n  }\n\n  // 2. Revenue Growth (5 points)\n  // Target: >20% = 5pts, 10-20% = 3pts, 5-10% = 1pt\n  const revenueGrowth = fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.revenueGrowth;\n  if (revenueGrowth !== null && revenueGrowth !== undefined) {\n    if (revenueGrowth >= 20) {\n      scores.revenueGrowth = 5;\n    } else if (revenueGrowth >= 10) {\n      scores.revenueGrowth = 3;\n    } else if (revenueGrowth >= 5) {\n      scores.revenueGrowth = 1;\n    }\n  }\n\n  // 3. ROE (4 points)\n  // Target: >15% = 4pts, 10-15% = 2pts\n  const roe = fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.roe;\n  if (roe !== null && roe !== undefined) {\n    if (roe >= 15) {\n      scores.roe = 4;\n    } else if (roe >= 10) {\n      scores.roe = 2;\n    } else if (roe > 0) {\n      scores.roe = 1;\n    }\n  }\n\n  // 4. Debt/Equity (3 points)\n  // Target: <1.0 = 3pts, 1.0-1.5 = 1pt\n  const debtToEquity = fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.debtToEquity;\n  if (debtToEquity !== null && debtToEquity !== undefined) {\n    if (debtToEquity < 0.5) {\n      scores.debtToEquity = 3; // Very low debt\n    } else if (debtToEquity < 1.0) {\n      scores.debtToEquity = 2;\n    } else if (debtToEquity < 1.5) {\n      scores.debtToEquity = 1;\n    }\n  }\n\n  // 5. Forward P/E (2 points)\n  // Target: <20 = 2pts, 20-25 = 1pt (reasonable valuation)\n  const forwardPe = fundamentals === null || fundamentals === void 0 ? void 0 : fundamentals.forwardPe;\n  if (forwardPe !== null && forwardPe !== undefined && forwardPe > 0) {\n    if (forwardPe < 20) {\n      scores.forwardPe = 2;\n    } else if (forwardPe < 25) {\n      scores.forwardPe = 1;\n    }\n  }\n  const totalScore = scores.epsGrowth + scores.revenueGrowth + scores.roe + scores.debtToEquity + scores.forwardPe;\n  return {\n    score: totalScore,\n    maxScore: 20,\n    details: {\n      epsGrowth: {\n        score: scores.epsGrowth,\n        max: 6,\n        value: epsGrowth\n      },\n      revenueGrowth: {\n        score: scores.revenueGrowth,\n        max: 5,\n        value: revenueGrowth\n      },\n      roe: {\n        score: scores.roe,\n        max: 4,\n        value: roe\n      },\n      debtToEquity: {\n        score: scores.debtToEquity,\n        max: 3,\n        value: debtToEquity\n      },\n      forwardPe: {\n        score: scores.forwardPe,\n        max: 2,\n        value: forwardPe\n      }\n    },\n    dataSource: dataSource,\n    dataQuality: dataQuality\n  };\n}\n\n/**\n * Calculate Sentiment Score (10 points)\n * Placeholder - real sentiment analysis in v2.0\n */\nfunction calculateSentimentScore() {\n  // TODO: Implement real sentiment analysis\n  // For now, return neutral score\n  return {\n    score: 5,\n    maxScore: 10,\n    details: {\n      newsScore: {\n        score: 5,\n        max: 10\n      }\n    },\n    note: 'Placeholder - real sentiment coming in v2.0'\n  };\n}\n\n/**\n * Calculate Risk/Macro Score (5 points)\n */\nfunction calculateRiskScore(spyData, vixData) {\n  let scores = {\n    vix: 0,\n    spyRegime: 0,\n    breadth: 0\n  };\n\n  // 1. VIX Level (2 points)\n  const vix = vixData === null || vixData === void 0 ? void 0 : vixData.current;\n  if (vix !== null && vix !== undefined) {\n    if (vix < 15) {\n      scores.vix = 2; // Low volatility - favorable\n    } else if (vix < 20) {\n      scores.vix = 1; // Normal volatility\n    }\n    // VIX > 20 = 0 points (elevated risk)\n  }\n\n  // 2. S&P 500 Regime (2 points)\n  if (spyData !== null && spyData !== void 0 && spyData.aboveSma200) {\n    scores.spyRegime = 2; // Bullish market regime\n  }\n\n  // 3. Market Breadth (1 point) - placeholder\n  // Would need % of stocks above 50 SMA\n  scores.breadth = 1; // Default to neutral\n\n  const totalScore = scores.vix + scores.spyRegime + scores.breadth;\n  return {\n    score: totalScore,\n    maxScore: 5,\n    details: {\n      vix: {\n        score: scores.vix,\n        max: 2,\n        value: vix\n      },\n      spyRegime: {\n        score: scores.spyRegime,\n        max: 2,\n        aboveSma200: spyData === null || spyData === void 0 ? void 0 : spyData.aboveSma200\n      },\n      breadth: {\n        score: scores.breadth,\n        max: 1\n      }\n    }\n  };\n}\n\n/**\n * Check Quality Gates (Auto-AVOID triggers)\n */\nfunction checkQualityGates(stockData, spyData, technicalResult) {\n  const gates = [];\n  const rsData = technicalResult === null || technicalResult === void 0 ? void 0 : technicalResult.rsData;\n  const indicators = technicalResult === null || technicalResult === void 0 ? void 0 : technicalResult.indicators;\n  const prices = stockData.priceHistory.map(d => d.close);\n  const currentPrice = prices[prices.length - 1];\n\n  // 1. RS below 0.8 (significant underperformance)\n  if (rsData !== null && rsData !== void 0 && rsData.rs52Week && rsData.rs52Week < 0.8) {\n    gates.push({\n      name: 'RS Below Threshold',\n      value: rsData.rs52Week.toFixed(2),\n      threshold: '< 0.8',\n      critical: true\n    });\n  }\n\n  // 2. Stock below 200 SMA (downtrend)\n  if (indicators !== null && indicators !== void 0 && indicators.sma200 && currentPrice < indicators.sma200) {\n    gates.push({\n      name: 'Below 200 SMA',\n      value: `$${currentPrice.toFixed(2)}`,\n      threshold: `> $${indicators.sma200.toFixed(2)}`,\n      critical: true\n    });\n  }\n\n  // 3. Average daily volume < $10M (illiquid)\n  const avgVolume = stockData.avgVolume || 0;\n  const avgDollarVolume = avgVolume * currentPrice;\n  if (avgDollarVolume < 10000000) {\n    gates.push({\n      name: 'Low Liquidity',\n      value: `$${(avgDollarVolume / 1000000).toFixed(1)}M`,\n      threshold: '> $10M',\n      critical: true\n    });\n  }\n\n  // Count critical failures\n  const criticalFails = gates.filter(g => g.critical).length;\n  return {\n    passed: criticalFails === 0,\n    gates: gates,\n    criticalFails: criticalFails\n  };\n}\n\n/**\n * Determine Verdict based on score and quality gates\n */\nfunction determineVerdict(totalScore, qualityGates, rsData) {\n  // Auto-AVOID conditions\n  if (qualityGates.criticalFails >= 2) {\n    return {\n      verdict: 'AVOID',\n      reason: `${qualityGates.criticalFails} critical failures`,\n      color: 'red'\n    };\n  }\n  if (rsData !== null && rsData !== void 0 && rsData.rs52Week && rsData.rs52Week < 0.8) {\n    return {\n      verdict: 'AVOID',\n      reason: 'RS significantly below market',\n      color: 'red'\n    };\n  }\n\n  // Score-based verdict\n  if (totalScore >= 60 && qualityGates.criticalFails === 0) {\n    // Additional check: RS must be >= 1.0 for BUY\n    if (rsData !== null && rsData !== void 0 && rsData.rs52Week && rsData.rs52Week >= 1.0) {\n      return {\n        verdict: 'BUY',\n        reason: `Strong score (${totalScore}/75) with good RS`,\n        color: 'green'\n      };\n    } else {\n      return {\n        verdict: 'HOLD',\n        reason: 'Good score but RS below 1.0',\n        color: 'yellow'\n      };\n    }\n  }\n  if (totalScore >= 40) {\n    return {\n      verdict: 'HOLD',\n      reason: `Moderate score (${totalScore}/75)`,\n      color: 'yellow'\n    };\n  }\n  return {\n    verdict: 'AVOID',\n    reason: `Low score (${totalScore}/75)`,\n    color: 'red'\n  };\n}\n\n/**\n * Main scoring function\n * Calculates complete analysis for a stock\n */\nexport function calculateScore(stockData, spyData, vixData) {\n  // Calculate individual scores\n  const technicalAnalysis = calculateTechnicalScore(stockData, spyData);\n  const fundamentalAnalysis = calculateFundamentalScore(stockData.fundamentals);\n  const sentimentAnalysis = calculateSentimentScore();\n  const riskAnalysis = calculateRiskScore(spyData, vixData);\n\n  // Total score\n  const totalScore = technicalAnalysis.score + fundamentalAnalysis.score + sentimentAnalysis.score + riskAnalysis.score;\n\n  // Quality gates\n  const qualityGates = checkQualityGates(stockData, spyData, technicalAnalysis);\n\n  // Verdict\n  const verdict = determineVerdict(totalScore, qualityGates, technicalAnalysis.rsData);\n\n  // Debug logging\n  console.log('=== SCORING ENGINE DEBUG ===');\n  console.log('Stock:', stockData.ticker);\n  console.log('Technical Score:', technicalAnalysis.score, '/', technicalAnalysis.maxScore);\n  console.log('Technical Details:', technicalAnalysis.details);\n  console.log('Fundamental Score:', fundamentalAnalysis.score, '/', fundamentalAnalysis.maxScore);\n  console.log('Fundamental Details:', fundamentalAnalysis.details);\n  console.log('Fundamental Data Source:', fundamentalAnalysis.dataSource);\n  console.log('Fundamental Data Quality:', fundamentalAnalysis.dataQuality);\n  console.log('Sentiment Score:', sentimentAnalysis.score, '/', sentimentAnalysis.maxScore);\n  console.log('Risk Score:', riskAnalysis.score, '/', riskAnalysis.maxScore);\n  console.log('Total Score:', totalScore, '/ 75');\n  console.log('Quality Gates:', qualityGates);\n  console.log('Verdict:', verdict);\n  console.log('============================');\n  return {\n    ticker: stockData.ticker,\n    name: stockData.name,\n    currentPrice: stockData.currentPrice,\n    totalScore: totalScore,\n    maxScore: 75,\n    verdict: verdict,\n    qualityGates: qualityGates,\n    breakdown: {\n      technical: technicalAnalysis,\n      fundamental: fundamentalAnalysis,\n      sentiment: sentimentAnalysis,\n      risk: riskAnalysis\n    },\n    rsData: technicalAnalysis.rsData,\n    indicators: technicalAnalysis.indicators,\n    timestamp: new Date().toISOString()\n  };\n}","map":{"version":3,"names":["calculateIndicators","calculateRS","calculateTechnicalScore","stockData","spyData","prices","priceHistory","map","d","close","volumes","volume","length","score","maxScore","details","error","indicators","currentPrice","scores","trendStructure","shortTermTrend","rs","sma50","sma200","ema8","ema21","avgVolume50","recentVolume","slice","reduce","a","b","volumeRatio","rsData","rs52Week","totalScore","max","relativeStrength","calculateFundamentalScore","fundamentals","epsGrowth","revenueGrowth","roe","debtToEquity","forwardPe","dataSource","enrichedSource","source","dataQuality","enriched","undefined","value","calculateSentimentScore","newsScore","note","calculateRiskScore","vixData","vix","spyRegime","breadth","current","aboveSma200","checkQualityGates","technicalResult","gates","push","name","toFixed","threshold","critical","avgVolume","avgDollarVolume","criticalFails","filter","g","passed","determineVerdict","qualityGates","verdict","reason","color","calculateScore","technicalAnalysis","fundamentalAnalysis","sentimentAnalysis","riskAnalysis","console","log","ticker","breakdown","technical","fundamental","sentiment","risk","timestamp","Date","toISOString"],"sources":["/Users/balajik/projects/swing-trade-analyzer/frontend/src/utils/scoringEngine.js"],"sourcesContent":["/**\n * Scoring Engine for Swing Trade Analyzer\n * 75-point scoring system based on Minervini SEPA + CAN SLIM\n * \n * v2.0: Enhanced fundamental scoring with Defeat Beta data\n * \n * Scoring Breakdown:\n * - Technical: 40 points\n * - Fundamental: 20 points (ENHANCED)\n * - Sentiment: 10 points (placeholder)\n * - Risk/Macro: 5 points\n */\n\nimport { calculateIndicators } from './technicalIndicators';\nimport { calculateRS } from './rsCalculator';\n\n/**\n * Calculate Technical Analysis Score (40 points)\n */\nfunction calculateTechnicalScore(stockData, spyData) {\n  const prices = stockData.priceHistory.map(d => d.close);\n  const volumes = stockData.priceHistory.map(d => d.volume);\n  \n  if (prices.length < 50) {\n    return { score: 0, maxScore: 40, details: {}, error: 'Insufficient price data' };\n  }\n  \n  const indicators = calculateIndicators(prices, volumes);\n  const currentPrice = prices[prices.length - 1];\n  \n  let scores = {\n    trendStructure: 0,\n    shortTermTrend: 0,\n    volume: 0,\n    rs: 0\n  };\n  \n  // 1. Trend Structure (15 points): Price > 50 SMA > 200 SMA\n  if (indicators.sma50 && indicators.sma200) {\n    if (currentPrice > indicators.sma50 && indicators.sma50 > indicators.sma200) {\n      scores.trendStructure = 15; // Perfect Stage 2 uptrend\n    } else if (currentPrice > indicators.sma200) {\n      scores.trendStructure = 5; // Above 200 SMA but not ideal structure\n    }\n  }\n  \n  // 2. Short-term Trend (10 points): Price > 8 EMA > 21 EMA\n  if (indicators.ema8 && indicators.ema21) {\n    if (currentPrice > indicators.ema8 && indicators.ema8 > indicators.ema21) {\n      scores.shortTermTrend = 10; // Strong short-term momentum\n    } else if (currentPrice > indicators.ema21) {\n      scores.shortTermTrend = 3; // Above 21 EMA\n    }\n  }\n  \n  // 3. Volume (5 points): Recent volume vs 50-day average\n  if (indicators.avgVolume50) {\n    const recentVolume = volumes.slice(-5).reduce((a, b) => a + b, 0) / 5;\n    const volumeRatio = recentVolume / indicators.avgVolume50;\n    \n    if (volumeRatio >= 1.5) {\n      scores.volume = 5; // High volume interest\n    } else if (volumeRatio >= 1.0) {\n      scores.volume = 2; // Normal volume\n    }\n  }\n  \n  // 4. Relative Strength (10 points)\n  const rsData = calculateRS(stockData, spyData);\n  if (rsData && rsData.rs52Week) {\n    if (rsData.rs52Week >= 1.5) {\n      scores.rs = 10; // Strong outperformance\n    } else if (rsData.rs52Week >= 1.2) {\n      scores.rs = 7; // Good outperformance\n    } else if (rsData.rs52Week >= 1.0) {\n      scores.rs = 4; // Slight outperformance\n    } else if (rsData.rs52Week >= 0.8) {\n      scores.rs = 1; // Slight underperformance\n    }\n  }\n  \n  const totalScore = scores.trendStructure + scores.shortTermTrend + scores.volume + scores.rs;\n  \n  return {\n    score: totalScore,\n    maxScore: 40,\n    details: {\n      trendStructure: { score: scores.trendStructure, max: 15 },\n      shortTermTrend: { score: scores.shortTermTrend, max: 10 },\n      volume: { score: scores.volume, max: 5 },\n      relativeStrength: { score: scores.rs, max: 10 }\n    },\n    indicators: indicators,\n    rsData: rsData\n  };\n}\n\n/**\n * Calculate Fundamental Score (20 points)\n * ENHANCED with Defeat Beta data (ROE, ROIC, EPS Growth, etc.)\n */\nfunction calculateFundamentalScore(fundamentals) {\n  let scores = {\n    epsGrowth: 0,\n    revenueGrowth: 0,\n    roe: 0,\n    debtToEquity: 0,\n    forwardPe: 0\n  };\n  \n  let dataSource = fundamentals?.enrichedSource || fundamentals?.source || 'unknown';\n  let dataQuality = 'limited';\n  \n  // Check if we have enriched data from Defeat Beta\n  if (fundamentals?.enriched || fundamentals?.source === 'defeatbeta') {\n    dataQuality = 'rich';\n  }\n  \n  // 1. EPS Growth (6 points)\n  // Target: >25% YoY = 6pts, 15-25% = 4pts, 10-15% = 2pts\n  const epsGrowth = fundamentals?.epsGrowth;\n  if (epsGrowth !== null && epsGrowth !== undefined) {\n    if (epsGrowth >= 25) {\n      scores.epsGrowth = 6;\n    } else if (epsGrowth >= 15) {\n      scores.epsGrowth = 4;\n    } else if (epsGrowth >= 10) {\n      scores.epsGrowth = 2;\n    } else if (epsGrowth > 0) {\n      scores.epsGrowth = 1;\n    }\n  }\n  \n  // 2. Revenue Growth (5 points)\n  // Target: >20% = 5pts, 10-20% = 3pts, 5-10% = 1pt\n  const revenueGrowth = fundamentals?.revenueGrowth;\n  if (revenueGrowth !== null && revenueGrowth !== undefined) {\n    if (revenueGrowth >= 20) {\n      scores.revenueGrowth = 5;\n    } else if (revenueGrowth >= 10) {\n      scores.revenueGrowth = 3;\n    } else if (revenueGrowth >= 5) {\n      scores.revenueGrowth = 1;\n    }\n  }\n  \n  // 3. ROE (4 points)\n  // Target: >15% = 4pts, 10-15% = 2pts\n  const roe = fundamentals?.roe;\n  if (roe !== null && roe !== undefined) {\n    if (roe >= 15) {\n      scores.roe = 4;\n    } else if (roe >= 10) {\n      scores.roe = 2;\n    } else if (roe > 0) {\n      scores.roe = 1;\n    }\n  }\n  \n  // 4. Debt/Equity (3 points)\n  // Target: <1.0 = 3pts, 1.0-1.5 = 1pt\n  const debtToEquity = fundamentals?.debtToEquity;\n  if (debtToEquity !== null && debtToEquity !== undefined) {\n    if (debtToEquity < 0.5) {\n      scores.debtToEquity = 3; // Very low debt\n    } else if (debtToEquity < 1.0) {\n      scores.debtToEquity = 2;\n    } else if (debtToEquity < 1.5) {\n      scores.debtToEquity = 1;\n    }\n  }\n  \n  // 5. Forward P/E (2 points)\n  // Target: <20 = 2pts, 20-25 = 1pt (reasonable valuation)\n  const forwardPe = fundamentals?.forwardPe;\n  if (forwardPe !== null && forwardPe !== undefined && forwardPe > 0) {\n    if (forwardPe < 20) {\n      scores.forwardPe = 2;\n    } else if (forwardPe < 25) {\n      scores.forwardPe = 1;\n    }\n  }\n  \n  const totalScore = scores.epsGrowth + scores.revenueGrowth + scores.roe + \n                     scores.debtToEquity + scores.forwardPe;\n  \n  return {\n    score: totalScore,\n    maxScore: 20,\n    details: {\n      epsGrowth: { score: scores.epsGrowth, max: 6, value: epsGrowth },\n      revenueGrowth: { score: scores.revenueGrowth, max: 5, value: revenueGrowth },\n      roe: { score: scores.roe, max: 4, value: roe },\n      debtToEquity: { score: scores.debtToEquity, max: 3, value: debtToEquity },\n      forwardPe: { score: scores.forwardPe, max: 2, value: forwardPe }\n    },\n    dataSource: dataSource,\n    dataQuality: dataQuality\n  };\n}\n\n/**\n * Calculate Sentiment Score (10 points)\n * Placeholder - real sentiment analysis in v2.0\n */\nfunction calculateSentimentScore() {\n  // TODO: Implement real sentiment analysis\n  // For now, return neutral score\n  return {\n    score: 5,\n    maxScore: 10,\n    details: {\n      newsScore: { score: 5, max: 10 }\n    },\n    note: 'Placeholder - real sentiment coming in v2.0'\n  };\n}\n\n/**\n * Calculate Risk/Macro Score (5 points)\n */\nfunction calculateRiskScore(spyData, vixData) {\n  let scores = {\n    vix: 0,\n    spyRegime: 0,\n    breadth: 0\n  };\n  \n  // 1. VIX Level (2 points)\n  const vix = vixData?.current;\n  if (vix !== null && vix !== undefined) {\n    if (vix < 15) {\n      scores.vix = 2; // Low volatility - favorable\n    } else if (vix < 20) {\n      scores.vix = 1; // Normal volatility\n    }\n    // VIX > 20 = 0 points (elevated risk)\n  }\n  \n  // 2. S&P 500 Regime (2 points)\n  if (spyData?.aboveSma200) {\n    scores.spyRegime = 2; // Bullish market regime\n  }\n  \n  // 3. Market Breadth (1 point) - placeholder\n  // Would need % of stocks above 50 SMA\n  scores.breadth = 1; // Default to neutral\n  \n  const totalScore = scores.vix + scores.spyRegime + scores.breadth;\n  \n  return {\n    score: totalScore,\n    maxScore: 5,\n    details: {\n      vix: { score: scores.vix, max: 2, value: vix },\n      spyRegime: { score: scores.spyRegime, max: 2, aboveSma200: spyData?.aboveSma200 },\n      breadth: { score: scores.breadth, max: 1 }\n    }\n  };\n}\n\n/**\n * Check Quality Gates (Auto-AVOID triggers)\n */\nfunction checkQualityGates(stockData, spyData, technicalResult) {\n  const gates = [];\n  const rsData = technicalResult?.rsData;\n  const indicators = technicalResult?.indicators;\n  const prices = stockData.priceHistory.map(d => d.close);\n  const currentPrice = prices[prices.length - 1];\n  \n  // 1. RS below 0.8 (significant underperformance)\n  if (rsData?.rs52Week && rsData.rs52Week < 0.8) {\n    gates.push({\n      name: 'RS Below Threshold',\n      value: rsData.rs52Week.toFixed(2),\n      threshold: '< 0.8',\n      critical: true\n    });\n  }\n  \n  // 2. Stock below 200 SMA (downtrend)\n  if (indicators?.sma200 && currentPrice < indicators.sma200) {\n    gates.push({\n      name: 'Below 200 SMA',\n      value: `$${currentPrice.toFixed(2)}`,\n      threshold: `> $${indicators.sma200.toFixed(2)}`,\n      critical: true\n    });\n  }\n  \n  // 3. Average daily volume < $10M (illiquid)\n  const avgVolume = stockData.avgVolume || 0;\n  const avgDollarVolume = avgVolume * currentPrice;\n  if (avgDollarVolume < 10000000) {\n    gates.push({\n      name: 'Low Liquidity',\n      value: `$${(avgDollarVolume / 1000000).toFixed(1)}M`,\n      threshold: '> $10M',\n      critical: true\n    });\n  }\n  \n  // Count critical failures\n  const criticalFails = gates.filter(g => g.critical).length;\n  \n  return {\n    passed: criticalFails === 0,\n    gates: gates,\n    criticalFails: criticalFails\n  };\n}\n\n/**\n * Determine Verdict based on score and quality gates\n */\nfunction determineVerdict(totalScore, qualityGates, rsData) {\n  // Auto-AVOID conditions\n  if (qualityGates.criticalFails >= 2) {\n    return {\n      verdict: 'AVOID',\n      reason: `${qualityGates.criticalFails} critical failures`,\n      color: 'red'\n    };\n  }\n  \n  if (rsData?.rs52Week && rsData.rs52Week < 0.8) {\n    return {\n      verdict: 'AVOID',\n      reason: 'RS significantly below market',\n      color: 'red'\n    };\n  }\n  \n  // Score-based verdict\n  if (totalScore >= 60 && qualityGates.criticalFails === 0) {\n    // Additional check: RS must be >= 1.0 for BUY\n    if (rsData?.rs52Week && rsData.rs52Week >= 1.0) {\n      return {\n        verdict: 'BUY',\n        reason: `Strong score (${totalScore}/75) with good RS`,\n        color: 'green'\n      };\n    } else {\n      return {\n        verdict: 'HOLD',\n        reason: 'Good score but RS below 1.0',\n        color: 'yellow'\n      };\n    }\n  }\n  \n  if (totalScore >= 40) {\n    return {\n      verdict: 'HOLD',\n      reason: `Moderate score (${totalScore}/75)`,\n      color: 'yellow'\n    };\n  }\n  \n  return {\n    verdict: 'AVOID',\n    reason: `Low score (${totalScore}/75)`,\n    color: 'red'\n  };\n}\n\n/**\n * Main scoring function\n * Calculates complete analysis for a stock\n */\nexport function calculateScore(stockData, spyData, vixData) {\n  // Calculate individual scores\n  const technicalAnalysis = calculateTechnicalScore(stockData, spyData);\n  const fundamentalAnalysis = calculateFundamentalScore(stockData.fundamentals);\n  const sentimentAnalysis = calculateSentimentScore();\n  const riskAnalysis = calculateRiskScore(spyData, vixData);\n  \n  // Total score\n  const totalScore = technicalAnalysis.score + fundamentalAnalysis.score + \n                     sentimentAnalysis.score + riskAnalysis.score;\n  \n  // Quality gates\n  const qualityGates = checkQualityGates(stockData, spyData, technicalAnalysis);\n  \n  // Verdict\n  const verdict = determineVerdict(totalScore, qualityGates, technicalAnalysis.rsData);\n  \n  // Debug logging\n  console.log('=== SCORING ENGINE DEBUG ===');\n  console.log('Stock:', stockData.ticker);\n  console.log('Technical Score:', technicalAnalysis.score, '/', technicalAnalysis.maxScore);\n  console.log('Technical Details:', technicalAnalysis.details);\n  console.log('Fundamental Score:', fundamentalAnalysis.score, '/', fundamentalAnalysis.maxScore);\n  console.log('Fundamental Details:', fundamentalAnalysis.details);\n  console.log('Fundamental Data Source:', fundamentalAnalysis.dataSource);\n  console.log('Fundamental Data Quality:', fundamentalAnalysis.dataQuality);\n  console.log('Sentiment Score:', sentimentAnalysis.score, '/', sentimentAnalysis.maxScore);\n  console.log('Risk Score:', riskAnalysis.score, '/', riskAnalysis.maxScore);\n  console.log('Total Score:', totalScore, '/ 75');\n  console.log('Quality Gates:', qualityGates);\n  console.log('Verdict:', verdict);\n  console.log('============================');\n  \n  return {\n    ticker: stockData.ticker,\n    name: stockData.name,\n    currentPrice: stockData.currentPrice,\n    totalScore: totalScore,\n    maxScore: 75,\n    verdict: verdict,\n    qualityGates: qualityGates,\n    breakdown: {\n      technical: technicalAnalysis,\n      fundamental: fundamentalAnalysis,\n      sentiment: sentimentAnalysis,\n      risk: riskAnalysis\n    },\n    rsData: technicalAnalysis.rsData,\n    indicators: technicalAnalysis.indicators,\n    timestamp: new Date().toISOString()\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}